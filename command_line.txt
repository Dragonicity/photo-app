Create Application:

rails new app-name
rails generate controller welcome index
Change get 'welcome/index' to root 'welcome#index' in routes.rb

start rails server and confirm home page shows

git init
git add -A
git commit -m "Initial commit with home page"

Deploy to Production:

In gemfile move sqlite3 gem to development group and create production group:

group :production do
  gem 'pg'
  gem 'rails_12factor'
end

bundle install --without production

create github repository for app-name

git remote add origin https://github.com/Dragonicity/photo-app.git
git push -u origin master

heroku create
heroku rename required-name

git add -A
git commit -m "Make ready for production"
git push
git push heroku master

Build Authentication System:

add gems to gemfile

gem 'devise'
gem 'twitter-bootstrap-rails'
gem 'devise-bootstrap-views'

bundle install

rails generate devise:install
rails generate devise User

update migration file to allow for confirmable email authentication

uncomment confirmable attributes in database migration file

## Confirmable
      t.string   :confirmation_token
      t.datetime :confirmed_at
      t.datetime :confirmation_sent_at
      t.string   :unconfirmed_email # Only if using reconfirmable

add confirmable option to User model:

class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :confirmable, :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable, :confirmable,
         :recoverable, :rememberable, :trackable, :validatable
end

rake db:migrate

restart rails server

add line to application controller:

before_action :authenticate_user!

add line to welcome controller to skip authentication if needed

skip_before_action :authenticate_user!, only: [:index]

rails generate bootstrap:install static
rails generate bootstrap:layout application (and confirm with Y)
rails generate devise:views:locale en
rails generate devise:views:bootstrap_templates

In the application.css file under app/assets/stylesheets folder, right above the line that says *= require_tree add in the following line:

*= require devise_bootstrap_views

go to sign_up page

http://localhost:3000/users/sign_up

git add -A
git commit -m "Add devise and styling"
git push

Production email:

heroku addons:create sendgrid:starter

Click on Sendgrid add-on in Heroku, go to settings, credentials and add username and password for account. Click Mail checkbox and click create credential button.

heroku config:set SENDGRID_USERNAME=mark.nelson@dragonicity.com
heroku config:set SENDGRID_PASSWORD=password

ENter the following in the ~/.zshrc file:

export SENDGRID_USERNAME=mark.nelson@dragonicity.com
export SENDGRID_PASSWORD=password

Create new terminal session to see environment variables and do set-up

In config/environment.rb add the following code:

ActionMailer::Base.smtp_settings = {
  :address => 'smtp.sendgrid.net',
  :port => '587',
  :authentication => :plain,
  :user_name => ENV['SENDGRID_USERNAME'],
  :password => ENV['SENDGRID_PASSWORD'],
  :domain => 'heroku.com',
  :enable_starttls_auto => true
}

In config/environments/develop.rb add the following (under config.eager_load = false):

config.action_mailer.delivery_method = :test
config.action_mailer.default_url_options = { :host => 'http://localhost:3000' }

In config/environments/production.rb add the following:

config.action_mailer.delivery_method = :smtp
config.action_mailer.default_url_options = { :host => 'dragon-photo-app.herokuapp.com', :protocol => 'htpps' }

Sign-up to the application (should see message that email send to activate your account).

If you get undefined local variable or method 'confirmed_at' for Devise error then reset datbase with:

rake db:migrate:reset
rake db:reset

Select confirmation link from email details in server log and paste into browser

http://localhost:3000/users/confirmation?confirmation_token=cMp2szSz2kAmci4QdayS&amp;locale=en

You should see flash message Your account was successfully confirmed.

Update navigation to add relevant links:

In app/views/layouts.application.html.erb remove sidebar and then paste following text below links </ul>:

<ul class="nav navbar-right col-md-4">
<% if current_user %>
  <li class="col-md-8 user-name">
  <%= link_to ('<i class="fa fa-user"></i> ' + truncate(current_user.email, length: 25)).html_safe, edit_user_registration_path, title: 'Edit Profile' %>
  </li>
  <li class="col-md-1"> </li>
  <li class="col-md-3 logout"><%= link_to('Logout', destroy_user_session_path,
    class: 'btn btn-xs btn-danger', title: 'Logout', :method => :delete) %></li>
<% else %>
  <li class="col-md-4 pull-right">
    <%= link_to('Sign In', new_user_session_path, class: 'btn btn-primary', title: 'Sign In') %>
  </li>
<% end %>
</ul>

Change config/initializers/devise.rb:

config.mailer_sender = 'please-change-me-at-config-initializers-devise@example.com'

to e.g. admin@dragonicity.com

Test login and logout in development.

git add -A
git commit -m "Set-up email funcitonality for sign-up"
git push
git push heroku master
heroku run rake db:migrate

Test sign-up process and email in production:

heroku logs if error
heroku config shows heroku environment variables
(heroku run printenv will show all environment variables on heroku)

Open your index.html.erb page under app/views/welcome folder and fill in the code (or add styling as you like):

<% if current_user %>
  <h3>Welcome: <%= current_user.email %></h3>
<% else %>
  <div class="jumbotron"> 
    <h2>Welcome to the Photo Management App!</h2>
    <p class="lead">You'll love managing your Photos with our application. Sign up!
    </p>
  </div>
  <div class="row">
    <div class="plans clearfix">
      <div class="col-lg-3 col-lg-offset-3 plan">
        <h2>Premium Plan</h2>
        <div class="price pull-right">Price: $10
        </div>
        <div class="features">
          <ul>
            <li>Unlimited Image Uploads</li>
            <li>Responsive design</li>
            <li>Access anywhere</li>
          </ul>
        </div>
        <p>
        <%= link_to 'Sign Up', new_user_registration_path, class: 'btn btn-primary sign-up' %>
        </p>
      </div>
      <div class="col-lg-3 plan">
        <h2>Amaze Plan</h2>
        <div class="price pull-right">Price: $20
        </div>
        <div class="features">
          <ul>
            <li>Unlimited Image Uploads</li>
            <li>Responsive design</li>
            <li>Access anywhere</li>
            <li class='extra'>Unlimited projects</li>
          </ul>
        </div>
        <p>
        <%= link_to 'Sign Up', new_user_registration_path, class: 'btn btn-primary sign-up' %>
        </p>
      </div>
    </div>
  </div>
<% end %>

Then open your custom.css.scss file under app/assets/stylesheets folder and add the following to the bottom of the file, note: the file name in the asset-url for background-image below needs to be the name of the image file you upload to your app/assets/images folder:

.features {
  ul {
    margin-left: 0;
    padding-left: 15px;
  }
}

.jumbotron {
  text-align: center;
  background-image: asset-url('carousel.jpg');
  background-size: cover;
  color: #fff;
  font-family: 'Helvetica Neue' !important;
  font-stretch: expanded;
  padding-top: 25px;
  padding-bottom: 25px;
  margin-left: 15px;
  margin-right: 15px;
  text-shadow: -1px 0 #555, 0 1px #555, 1px 0 #555, 0 -1px #555;
/*

  h2 {
    font-size: 35px !important;
    .lead {
      font-family: 'Helvetica Neue' !important;
      font-size: 30px !important;
    }
  } */
}

.no-left-padding {
  padding-left: 0 !important;
}

.listing { 
  list-style: none;
  padding-left: 0;
}

In the application.html.erb page under app/views/layouts folder, change the following to col-lg-12 from col-lg-9:

<div class="container">
      <div class="row">
        <div class="col-lg-12">
          <%= bootstrap_flash %>
          <%= yield %>

Go to stripe.com and sign-up for an account








